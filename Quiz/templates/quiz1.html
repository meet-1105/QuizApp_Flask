<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <link rel="stylesheet" type="text/css" href=" {{url_for('static', filename='main.css') }}">

    {% if title %}
        <title>QUIZ - {{ title }}</title>
    {% else %}
        <title>QUIZ</title>
    {% endif %}

    <title>Quizzes </title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css">
<!--    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js">-->
    <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>

<style>
body {
  background-image: url('static/img/allbg.webp');
  background-size: 100%;
}

   .next_btn:hover {
            color: white;
            background-color: green;
        }

   .prev_btn:hover {
            color: white;
            background-color: green;
        }
    .card {
  display: none;
  }
  }
.row {
  display: flex;
  padding:20px;
}

.left_div {
    flex: 1000px;
    padding: 40px;
    height: 302px
}
.right_div{
       flex: 84px;
    height: 400px;
}
.button_div{
  flex: 70%;
  padding: 40px;
  height: 200px;
}
.prev_btn{
    margin-top: 20px;
    width: 125px;
    height: 50px;
    border: 1px solid;
    border-radius: 60px;
}
.submit_btn{
  position: fixed;
  left: 30%;
  top:50%;
  margin-top: 150px;
    width: 20%;
    height: 60px;
    border-radius: 48px;
    border:2px solid black;

}
.submit_btn:hover {
  background-color: #555555;
  color: white;
}
.next_btn{
float:right;
margin-top: 20px;
    width: 125px;
    height: 50px;
    border: 1px solid;
    border-radius: 60px;
}
}

.container1{
margin-top:30%;
}
.count-name{
    margin-left: 40px;
    position: relative;
    margin-top: 100px;
}

span.a {
  padding-left:10px;
  padding-right:10px;
  margin-bottom:50%;
  margin-left:140%;
  border: 3px solid black;
}
.timer{
    margin-top: 125px;
    margin-left: 1004px;
    position: absolute;
    border: 1px solid;
    width: 130px;
    text-align: center;
    font-size: 30px;
    border-radius: 15px;
}
</style>

</head>
<body onload="clock()" oncopy="return false" oncut="return false"  >
<header class="site-header">
      <nav class="navbar navbar-expand-md navbar-dark bg-steel fixed-top">
        <div class="container">
          <a class="navbar-brand mr-4" href="{{ url_for('home') }}">QUIZ </a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarToggle" aria-controls="navbarToggle" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarToggle">
            <div class="navbar-nav mr-auto">
        &nbsp&nbsp   <a class="nav-item nav-link" href="{{ url_for('home') }}">Home</a>
                &nbsp&nbsp<a class="nav-item nav-link" href="{{ url_for('quiz_history')}}">Quiz History</a>


            </div>
            <!-- Navbar Right Side -->
            <div class="navbar-nav">
                <a class="nav-item nav-link">{{username}}</a>

                  <a class="nav-item nav-link" href="{{ url_for('logout')}}">Logout</a>

            </div>
          </div>
        </div>
      </nav>
    </header>
<div1  class="container1">
                <div class="timer" id="timer"></div>

    <div2 class="row">

           <h4  class="count-name" id="count"style="margin-left:40px;"></h4>

        <div3 class="left_div">
            <form method="post" id="quiz-form" action="/quiz_taken"name="myForm" >

            {% for qa in qa_list%}

                <div class = 'card '>
                    <div class = 'card-block' style="padding:10px;">
            <h4>{{loop.index}}{{". "+qa.question}}</h4>
            <br/>
                    <input type="radio" index="{{loop.index}}" id="{{qa.get('options').get('option1')}}" name="question-{{qa.id}}" value="{{qa.get('options').get('option1')}}">
                       <label for="{{qa.get('options').get('option1')}}"> {{qa.get('options').get('option1')}}</label><br/>
                    <input type="radio" index="{{loop.index}}" id="{{qa.options['option2']}}" name="question-{{qa.id}}" value="{{qa.get('options').get('option2')}}">
                       <label for="{{qa.options['option2']}}"> {{qa.options['option2']}}</label><br/>
                    <input type="radio" index="{{loop.index}}" id="{{qa.options['option3']}}" name="question-{{qa.id}}"value="{{qa.get('options').get('option3')}}">
                       <label for="{{qa.options['option3']}}"> {{qa.options['option3']}}</label> <br/>
                    <input type="radio" index="{{loop.index}}" id="{{qa.options['option4']}}" name="question-{{qa.id}}" value="{{qa.get('options').get('option4')}}">

                     <label for="{{qa.options['option4']}}" > {{qa.options['option4']}}</label>
                        <input type="hidden" name="question-{{qa.id}}"  value="--"/>

                    </div>
                    </div>
            {% endfor%}

                            <button class="prev_btn" type="button"  id="prevBtn" onclick="nextPrev(-1)">Previous</button>

                            <button class="next_btn" type="button"  id="nextBtn" onclick="nextPrev(1)">Next</button>
                            <button class="submit_btn" type="submit" id="submit-btn" >Submit Quiz</button>

</form>

        </div3>
        <div4  id="pagination" class="right_div">



        </div4>

    </div2>

</div1>

</body>

<script>

var checked = document.querySelectorAll('input[type="radio"]:checked');

var currentTab = 0; // Current tab is set to be the first tab (0)
showTab(currentTab); // Display the current tab

var arr = document.getElementsByClassName('card')

for (let index = 0; index < arr.length; index++) {
    const element = arr[index];
    var page = document.createElement('button')
    page.innerText = index + 1
    page.className = 'page btn btn-success border'
    document.getElementById('pagination').append(page)

}


$(".card").click(function(){
  $('.page')[$(this).find('input[type="radio"]:checked').attr('index')-1].classList.add('btn-success')
})


function showTab(n) {
  // This function will display the specified tab of the form...
  var x = document.getElementsByClassName("card");
  x[n].style.display = "block";
  //... and fix the Previous/Next buttons:
  if (n == 0) {
    document.getElementById("prevBtn").style.display = "none";
  } else {
    document.getElementById("prevBtn").style.display = "inline";
  }
  if (n == (x.length - 1)) {

    document.getElementById("nextBtn").style.display='none'
    document.getElementById('submit-btn').style.display='block'
    document.getElementById('submit-btn').addEventListener('click',function(){
        document.getElementById('quiz-form').submit()
    })
  } else {
    document.getElementById("nextBtn").innerHTML = "Next";
  }
  document.getElementById('count').innerText=` ${n + 1} out of ${x.length} `
  //... and run a function that will display the correct step indicator:
//   fixStepIndicator(n)
}

function nextPrev(n) {
  // This function will figure out which tab to display
  var x = document.getElementsByClassName("card");
  // Exit the function if any field in the current tab is invalid:
//   if (n == 1 && !validateForm()) return false;
  // Hide the current tab:
  x[currentTab].style.display = "none";
  // Increase or decrease the current tab by 1:
  currentTab = currentTab + n;
  console.log(currentTab)
  // if you have reached the end of the form...
  if (currentTab >= x.length) {
    // ... the form gets submitted:
    document.getElementById("regForm").submit();
    return false;
  }
  // Otherwise, display the correct tab:
  showTab(currentTab);
}


function fixStepIndicator(n) {
  // This function removes the "active" class of all steps...
  var i, x = document.getElementsByClassName("step");
  for (i = 0; i < x.length; i++) {
    x[i].className = x[i].className.replace(" active", "");
  }
  //... and adds the "active" class on the current step:
  x[n].className += " active";
}


$('.page').click(function(){
    for (let index = 0; index < $('.page').length; index++) {

        if(index == $(this).text()-1){
            $('.card')[index].style.display='block'
            $("#count").text(`${index+1} out of ${$('.page').length}`)

          }
        else{
            $('.card')[index].style.display='none'
        }

    }
})

<!--khushboo's script-->


 window.addEventListener('beforeunload', function (e) {
    e.preventDefault();
    e.returnValue = '';
});
        document.addEventListener('contextmenu', event => event.preventDefault());
        document.addEventListener("visibilitychange", function(e) {

            if (document.hidden){
                alert("Tab Switched!!!");
                document.getElementById('quiz-form').submit();
            }
        });
    var myTimer;
    function clock() {
    myTimer = setInterval(myClock, 1000);
    var c = 601;

    function myClock() {
        --c

        var seconds = c % 60;
        var secondsInMinutes = (c - seconds) / 60;
        var minutes = secondsInMinutes % 60;
        document.getElementById('timer').innerHTML = String(minutes).padStart(2, '0') + ":" + String(seconds).padStart(2, '0');
        if (c == 0) {
            clearInterval(myTimer);
            alert(" Time out!! :( ");
            document.getElementById('quiz-form').submit();

        }
    }
}

</script>

</html>